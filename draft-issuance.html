<!DOCTYPE html>
<html>
<head>
    <title>Draft issuance: Smooth Out The Block Subsidy Issuance</title>
    <meta charset="utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="css/style.css">
</head>
<body>
<pre><code>ZIP: 
Title: Smooth Out The Block Subsidy Issuance
Owners: Jason McGee &lt;jason@shieldedlabs.com&gt;
        Mark Henderson &lt;mark@equilibrium.co&gt;
        Tomek Piotrowski &lt;tomek@eiger.co&gt;
        Mariusz Pilarek &lt;mariusz@eiger.co&gt;
Original-Authors: Nathan Wilcox
Credits: Nathan Wilcox
         Mark Henderson
         Jason McGee
Status: Draft
Category: Consensus
Created: 2023-08-23
License: BSD-2-Clause</code></pre>
<h1 id="terminology">Terminology</h1>
<p>The key words “MUST”, “SHOULD”, “SHOULD NOT”, “MAY”, “RECOMMENDED”,
“OPTIONAL”, and “REQUIRED” in this document are to be interpreted as
described in RFC 2119. [1]</p>
<p>“Network upgrade” - to be interpreted as described in ZIP 200.
[2]</p>
<p>“Block Subsidy” - the algorithmic issuance of ZEC on block creation –
part of the consensus rules. Split between the miner and the Dev Fund.
Also known as Block Reward.</p>
<p>“Issuance” - The method by which unmined or unissued ZEC is converted
to ZEC available to users of the network</p>
<p>“We” - the ZIP authors, owners listed in the above front matter</p>
<p>“<code>AVAILABLE_SUBSIDIES(h)</code>” is the total ZEC available to
pay out Block Subsidies from at block height <code>h</code>, ie. “not
yet mined ZEC at h”.</p>
<p>“<code>BLOCK_SUBSIDY_FRACTION</code>” = 41 / 100,000,000 or
<code>0.00000041</code></p>
<h1 id="abstract">Abstract</h1>
<p>This ZIP proposes a change to how nodes calculate the block
subsidy.</p>
<p>Instead of following a step function around the four-year halving
cycle inherited from Bitcoin, we propose a slow exponential “smoothing”
of the curve. The new issuance scheme would approximate the current 4
year cycle, and results in the last zatoshi being spent in around 113
years.</p>
<h1 id="motivation">Motivation</h1>
<p>Zcash’s economic model is inherited from Bitcoin and includes the
concept of a halving mechanism to regulate the issuance of new coins.
This approach, though foundational, invites a reevaluation amid Zcash’s
ongoing evolution. As the network matures, the need to address potential
future challenges and ensure a sustained and stable economic ecosystem
becomes apparent. The transition to a smoothed emissions curve offers an
opportunity to adjust the network’s issuance dynamics while maintaining
the supply cap of 21,000,000 coins. By doing so, Zcash endeavors to
optimize its economic framework, accommodating changing circumstances
while maintaining predictability and stability in rewards
distribution.</p>
<p>This proposal outlines a solution to address challenges associated
with the existing block subsidy issuance mechanism in the Zcash network.
The primary goal of this proposal is to introduce a more predictable and
stable issuance of ZEC by smoothing out the issuance curve while
preserving the supply cap. It’s important to note that this proposal
does not seek to alter the fundamental aspects of Zcash’s issuance
policy. The average block subsidy size over time will remain the same
and the funds for block subsidies will last a similar amount of time.
Instead, it focuses solely on enhancing the predictability and
consistency of the block subsidy issuance process.</p>
<p>Smoothing the emissions curve helps ensure that the network remains
economically viable and stable as it transitions from a traditional
issuance mechanism to one that maintains a sustainable and predictable
issuance of rewards over time. It prevents abrupt changes in the rate of
newly issued coins, which could lead to disruptions in the network’s
economic model and potentially impact its security and sustainability. A
smoother emissions curve allows for a more gradual and controlled
transition, providing ZEC stakeholders and participants with a clear
understanding of how rewards will be distributed over time.</p>
<h1 id="specification">Specification</h1>
<p>Smoothing the issuance curve is possible using an exponential decay
formula that satisfies the following requirements:</p>
<h2 id="requirements">Requirements</h2>
<ol type="1">
<li>Block subsidies MUST be weakly decreasing</li>
<li>Block subsidies SHOULD approximate a continuous function</li>
<li>When <code>AVAILABLE_SUBSIDIES(h) &gt; 0</code> then block subsidies
for block <code>h</code> MUST always be <code>&gt; 0</code>, preventing
a final “unmined” zatoshi</li>
<li>For any 4 year period, all paid out block subsidies MUST equal
approximately half of <code>AVAILABLE_SUBSIDIES</code> at the beginning
of that 4 year period</li>
<li>This functionality MUST be introduced as part of a network
upgrade</li>
</ol>
<p>The above requirements assume no deflationary action, i.e. that no
ZEC is added to <code>AVAILABLE_SUBSIDIES</code>. They are referenced
below as <strong>Rn</strong>.</p>
<h2 id="solution">Solution</h2>
<p>Given the block height <code>h</code> define a function
<strong>S</strong>, such that:</p>
<p><strong>S(h)</strong> = Block subsidy for a given <code>h</code>,
that satisfies above requirements.</p>
<p>Please note that</p>
<p><code>AVAILABLE_SUBSIDIES(h+1) = AVAILABLE_SUBSIDIES(h) - S(h)</code>
assuming no deflationary action.</p>
<p>An exponential decay function <strong>S</strong> satisfies
<strong>R1</strong> and <strong>R2</strong> above:</p>
<p><code>S(h) = BLOCK_SUBSIDY_FRACTION * AVAILABLE_SUBSIDIES(h)</code></p>
<p>Finally, to satisfy <strong>R3</strong> above we need to always round
up to at least 1 Zatoshi if
<code>AVAILABLE_SUBSIDIES(h) &gt; 0</code>:</p>
<p><code>S(h) = ROUND_UP(BLOCK_SUBSIDY_FRACTION * AVAILABLE_SUBSIDIES(h))</code></p>
<h1 id="rationale">Rationale</h1>
<h2 id="block_subsidy_fraction"><code>BLOCK_SUBSIDY_FRACTION</code></h2>
<p>That value of <code>41 / 100_000_000</code> was selected so that it
satisfies the equation:</p>
<p><code>(1 - BLOCK_SUBSIDY_FRACTION)^NUMBER_OF_BLOCKS_IN_4_YEARS ~ ½</code></p>
<p>Meaning after a period of 4 years around half of
<code>AVAILABLE_SUBSIDIES</code> will be paid out as block subsidies,
thus satisfying <strong>R4</strong>.</p>
<h2 id="other-notes">Other Notes</h2>
<p>The suggested implementation avoids using float numbers. Rust and C++
will both round the result of the final division up, satisfying
<strong>R3</strong> above.</p>
<h1 id="appendix-simulation">Appendix: Simulation</h1>
<p>We encourage readers to run the following Rust code, which simulates
block subsidies. According to this simulation, assuming no deflationary
action, block subsidies would last for approximately 113 years:</p>
<h2 id="rust-code">Rust Code</h2>
<div class="sourceCode" id="cb2"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// approximate available subsidies in August of 2023</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> available_subsidies<span class="op">:</span> <span class="dt">i64</span> <span class="op">=</span> <span class="dv">4671731</span> <span class="op">*</span> <span class="dv">100_000_000</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> block<span class="op">:</span> <span class="dt">u32</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> available_subsidies <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">{</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> block_subsidy <span class="op">=</span> (available_subsidies <span class="op">*</span> <span class="dv">41</span> <span class="op">+</span> <span class="dv">99_999_999</span>) <span class="op">/</span> <span class="dv">100_000_000</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        available_subsidies <span class="op">-=</span> block_subsidy<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;{} ({} years): {}({} ZEC) {}({} ZEC)&quot;</span><span class="op">,</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            block<span class="op">,</span>                             <span class="co">// current block</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            block <span class="op">/</span> <span class="dv">420_768</span><span class="op">,</span>                   <span class="co">// ~ current year</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            block_subsidy<span class="op">,</span>                     <span class="co">// block subsidy in zatoshis</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            block_subsidy <span class="op">/</span> <span class="dv">100_000_000</span><span class="op">,</span>       <span class="co">// block subsidy in ZEC</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            available_subsidies<span class="op">,</span>               <span class="co">// available subsidies in zatoshis</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            available_subsidies <span class="op">/</span> <span class="dv">100_000_000</span>  <span class="co">// available subsidies in ZEC</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        block <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>   </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Last line of output of the above program is:</p>
<p><code>47699804 (113 years): 1(0 ZEC) 0(0 ZEC)</code></p>
<p>Note the addition of 99,999,999 before division to force rounding up
of non-zero values.</p>
</body>
</html>
